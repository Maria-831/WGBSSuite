<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Wgbssuite by SystemsGeneticsSG</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Wgbssuite</h1>
      <h2 class="project-tagline">The code from the WGBSsuite paper</h2>
      <a href="https://github.com/SystemsGeneticsSG/WGBSSuite" class="btn">View on GitHub</a>
      <a href="https://github.com/SystemsGeneticsSG/WGBSSuite/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/SystemsGeneticsSG/WGBSSuite/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="welcome-to-wgbssuite-pages" class="anchor" href="#welcome-to-wgbssuite-pages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Welcome to WGBSSuite Pages.</h3>

<p>We have developed WGBS Suite in order to allow anyone to asses which WGBS analysis package is the best fit for their data. We provide a tool to analyse your data in order to simulate data of the same type. This data can then be used to benchmark existing analysis methods either automatically (BSmooth, MethylKit and MethylSig) or independently on any existing package. Doing this will help you identify the best package to use for your downstream analysis, hence increase the quality of your analysis overall.</p>

<h3>
<a id="the-simulator" class="anchor" href="#the-simulator" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Simulator</h3>

<p>The simulator is summarised in three sections; (A) Firstly the locations of the CpG are simulated using a 2 state hidden Markov model.  (B)Next the methylation status for each CpG is simulated using a modulated hidden Markov model that ensures that CpG sites that are close together are more likely to have coordinated behaviour. (C) Finally the methylation profile is calculated producing a simulated number of methylated and de-methylated reads at each CpG. The statistical framework for this simulated can be switched between binomial and negative-binomial depending on which distribution you think better fits your data.</p>

<h3>
<a id="the-benchmarking" class="anchor" href="#the-benchmarking" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Benchmarking</h3>

<p>The benchmarking currently uses MethylKit, BSmooth , MethylSeq and the Fisher Exact Test. We will be working to encorportate more in the future however it is very easy to simulate data and use it to test any analysis software of your choice. The benchmarking that we have carried out so far shows that the performance is very context dependent with different packages performing very differently depending on coverage and distribution assumption. As an example, the following is an ROC analysis based binomial (D) and negative-binomially (E) distributed methylation counts.</p>

<h3>
<a id="before-starting" class="anchor" href="#before-starting" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Before starting</h3>

<p>Install R: You will need to install the correct version of R for your operating system. In order to do this visit the R mirror that is closest to your location from: <a href="http://www.r-project.org/">http://www.r-project.org/</a>
Install Bsmooth: Download and install the code for bsseq from here: <a href="http://rafalab.jhsph.edu/bsmooth/">http://rafalab.jhsph.edu/bsmooth/</a>
Install MethylSig:Download and install the code for bsseq from here: <a href="http://sartorlab.ccmb.med.umich.edu/node/17">http://sartorlab.ccmb.med.umich.edu/node/17</a>
Install MethylKit:Download and install the code for bsseq from here: <a href="https://code.google.com/p/methylkit/">https://code.google.com/p/methylkit/</a></p>

<h3>
<a id="installing-the-software" class="anchor" href="#installing-the-software" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installing the software</h3>

<p>Clone the code in a directory that you have read/write permissions. eg /home/USERNAME/bin/WGBSSuite/</p>

<p><code>git clone https://github.com/SystemsGeneticsSG/WGBSSuite.git</code></p>

<p><code>cd /home/USERNAME/bin/WGBSSuite</code></p>

<p>If this directory is not already in your PATH then you can add it using the following command:</p>

<p><code>export PATH=$PATH:/home/USERNAME/bin/WGBSSuite/R</code></p>

<h3>
<a id="quickstart" class="anchor" href="#quickstart" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Quickstart</h3>

<p>You will need to have you data in the correct format (see below) then follow these steps:</p>

<p>Analysing your data:From the command line simply type:</p>

<p><code>Rscript analyse_WGBS.R</code></p>

<p>This will run the analysis script in interactive mode, for more details on how to run this script read the advanced guide below. The results of this script will be written to a folder that you select at runtime and include graphs and statistics about the dataset that can be used to parametrise the simulation. The result of this will be a set of parameters for the simulation but also a summary document of the input data, eg. analysis_of_real_data.pdf. This document can be used to visualise the properties of a dataset for example the distribution of read counts or methylated proportion.</p>

<p>Simulating data: From the command simply type,</p>

<p><code>Rscript simulate_WGBS.R interactive</code></p>

<p>This will run the simulation script in interactive mode, for more details on how to run this script read the advanced guide below. The results of this script will be written to a folder that you select at runtime and include graph and the raw data that can be used for the benchmarking step or within R to test any WGBS software.</p>

<p>Benchmarking the tools: From the command line simply type,</p>

<p><code>Rscript benchmark_WGBS.R interactive</code></p>

<p>This will run the benchmark script in interactive mode, for more details on how to run this script read the advanced guide below. You will be required to enter the filename for the data you have simulated from the previous step as one of the options. This will produce an ROC, AUC  and runtime plot for the dataset.</p>

<h3>
<a id="advanced-guide" class="anchor" href="#advanced-guide" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Advanced Guide</h3>

<p>Simulating and Benchmarking the data in non-interactive mode:This runs the simulation and benchmarking in a loop and produces an averaged ROC, AUC and runtime analysis. This approach should be used to get the most accurate idea of the performance of a package. The result of this will be a set of simulated data, all store in /tmp/myWGBSanalysis. As well as this will be individual and the averaged analysis plots.</p>

<p><code>Rscript simulate_WGBS.R multi 5000 0.9203 0.076 0.1 0.1 29 29 3 2 0.1 0.5 0.019,0.002 /tmp/myWGBSanalysis binomial 10</code></p>

<ul>
<li>  Arg1: multi – This indicates that you wish to perform repeats of the same settings in order to produce an ROC/AUC analysis.</li>
<li>    Arg2: 5000 – This is the number of CpG sites to simulate</li>
<li>    Arg3: 0.9203 – This is the probability of success in the methylated region. This can be approximated using the analysis script as explained above.</li>
<li>    Arg4: 0.076 – This is the probability of success in the de-methylated region. This can be approximated using the analysis script as explained above.</li>
<li>    Arg5: 0.1 – This is the size of the error in the methylated region. This can be approximated using the analysis script as explained above.</li>
<li>    Arg6: 0.1 – This is the size of the error in the de-methylated region. This can be approximated using the analysis script as explained above.</li>
<li>    Arg7: 29 – This is the average number of reads in the methylated region. This can be approximated using the analysis script as explained above.</li>
<li>    Arg8: 29 – This is the average number of reads in the de-methylated region. This can be approximated using the analysis script as explained above.</li>
<li>    Arg9: 3 – This is the number of replicates to be simulated.</li>
<li>    Arg10: 2 – This is the number of samples to be simulated.</li>
<li>    Arg11: 0.1 – This is the phase difference in the differentially methylated regions.</li>
<li>    Arg12: 0.5 – This is the balance of hypo/hyper methylation.</li>
<li>    Arg13:  0.19, 0.02 – This is the matrix of values that describes the exponential decay functions that define the distances between CpG values.</li>
<li>    Arg14: /tmp/my WGBSanalysisfiles – This is the location and prefix of the files that will be written out.</li>
<li>    Arg15: binomial – This can be either binomial or truncated and defines the distribution of methylated reads at each CpG.</li>
<li>    Arg16: 10 – The number of repeats to run for the ROC analysis.</li>
</ul>

<p>Using the simulated data on other packages:The following command will create a file that can be used to test any WGBS package as follows,</p>

<p><code>Rscript simulate_WGBS.R 5000 0.9203 0.076 0.1 0.1 29 29 3 2 0.1 0.5 0.019,0.002 /tmp/myWGBSanalysis binomial</code></p>

<p>Once this has executed you will find the simulated data in the file “/tmp/myWGBSanalysis_5000_1_0.65_0.2_0.35_0.8_0.9_0.1_0.1_0.9_29_29_0.9203_0.076_0.1_0.1_0_0.1_0.5_.txt”. The data in this file has the following format:</p>

<ul>
<li>    V1: location in base pairs</li>
<li>    V2: differentially methylated flag</li>
</ul>

<p>blocks of 4 columns for each replica as follows:</p>

<ul>
<li>    Vn: Number of methylated reads</li>
<li>    Vn+1: Number of de-methylated reads</li>
<li>    Vn+2: Total number of reads</li>
<li>    Vn+3: Proportion of methylated vs de-methylated reads</li>
</ul>

<p>This information is sufficient to test any differential methylation software.</p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p><a href="https://github.com/owenrackham" class="user-mention">@owenrackham</a></p>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>please email me <a href="mailto:owen.rackham@duke-nus.edu.sg">owen.rackham@duke-nus.edu.sg</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/SystemsGeneticsSG/WGBSSuite">Wgbssuite</a> is maintained by <a href="https://github.com/SystemsGeneticsSG">SystemsGeneticsSG</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
